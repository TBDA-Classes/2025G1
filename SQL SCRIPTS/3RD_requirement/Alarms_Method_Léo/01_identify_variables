-- 1) Identify candidate alarm-related variables in the string logs
--    We search for messages containing alarm keywords.

SELECT DISTINCT
  s.id_var,
  v.name AS variable_name    
FROM variable_log_string s
JOIN variable v
  ON v.id = s.id_var         -- join key is v.id
WHERE s.value ILIKE '%error%'
   OR s.value ILIKE '%stop%'
   OR s.value ILIKE '%fail%'
   OR s.value ILIKE '%fault%'
   OR s.value ILIKE '%parada%'
   OR s.value ILIKE '%emergenc%'
   OR s.value ILIKE '%PLC%'
ORDER BY s.id_var;
