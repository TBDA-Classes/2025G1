--We will identify the time intervals between each log of the variable 447, because it is this variable that records the major alarms.
--We sort the logs by date, then calculate the time difference between one alarm and the next. This will give you the duration of inactivity or the time lapse between two events.

SELECT
  id_var,
  to_timestamp(date / 1000) AS log_time,
  value,
  LAG(to_timestamp(date / 1000)) OVER (PARTITION BY id_var ORDER BY date) AS previous_log_time,
  EXTRACT(EPOCH FROM (to_timestamp(date / 1000) -
                      LAG(to_timestamp(date / 1000)) OVER (PARTITION BY id_var ORDER BY date))) AS seconds_since_last_log
FROM variable_log_string
WHERE id_var = 447
  AND value IS NOT NULL
  AND value <> '[]'
ORDER BY date ASC
LIMIT 200;

--results : 
--the exact date, the stop or error message, and a calculated column showing the difference in seconds compared to the previous log.

